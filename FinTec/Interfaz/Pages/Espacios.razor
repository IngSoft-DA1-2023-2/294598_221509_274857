@page "/home/{Id:int}/{Correo}/Espacios"
@inject NavigationManager NavigationManager

@using BussinesLogic
@using Domain
@inject UsuarioLogic UsuarioLogic;
@inject EspacioLogic EspacioLogic;

<PageTitle>FinTec Registro de Usuario</PageTitle>

@foreach (var espacio in espacios)
{
	<div class="card">
		<div class="card-body">
			<h5 class="card-title"><strong>Nombre</strong>@espacio.Nombre</h5>
			<p class="card-text"><Strong>Admin:</Strong>@($"{espacio.Admin.Nombre} {espacio.Admin.Apellido}")</p>
			<button class="btn btn-primary" href="/home/{Id:int}/{Correo}">Ingresar</button>
			@if (espacio.Admin.Correo == Correo)
			{
				<button class="btn btn-primary" @onclick="() => ClickCambiarNombre(espacio)">Cambiar Nombre</button>
			}
		</div>
	</div>
}

<a class="btn btn-success btn-sm" href="/home/@Id/@Correo/CrearEspacio">Crear Espacio</a>


@code {
	[Parameter] public int Id { get; set; }
	[Parameter] public string Correo { get; set; }
	public List<Espacio> espacios { get; set; } = new List<Espacio>();
	public Usuario usuario { get; set; } = new Usuario();
	protected override void OnInitialized()
	{
		espacios = EspacioLogic.EspaciosByCorreo(Correo);
		usuario = UsuarioLogic.UsuarioByCorreo(Correo);
	}

	private void ClickCambiarNombre(Espacio espacio)
	{
		// Cambiar el nombre del espacio
		espacio.Nombre = "HOLA";

		// Redireccionar a otra página
		string newHref = $"/home/{Id}/{Correo}/Espacios";
		NavigationManager.NavigateTo(newHref);
	}

}
