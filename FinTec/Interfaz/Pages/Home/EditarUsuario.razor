@page "/home/{Id:int}/{Correo}/EditarUsuario"
@inject NavigationManager NavigationManager
@using BussinesLogic
@using Domain
@inject UsuarioLogic UsuarioLogic
@inject EspacioLogic EspacioLogic
@inject Persistencia Persistencia

<PageTitle>Editar Usuario</PageTitle>
<TituloRosado Titulo="Editar Usuario" Subtitulo="Configure sus datos personales."></TituloRosado>
<EspacioActual></EspacioActual>

<div class="grid md:grid-cols-2 md:gap-6">
    <div class="relative z-0 w-full mb-6 group">
        <input type="text" @bind="nombreInput" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder="Nombre" />
    </div>
    <div class="relative z-0 w-full mb-6 group">
        <input type="text" @bind="apellidoInput" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder="Apellido" />
    </div>
</div>
<div class="relative z-0 w-full mb-6 group">
    <input type="password" @bind="passwordInput" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder="Contraseña" />
</div>
<div class="relative z-0 w-full mb-6 group">
    <input type="text" @bind="direccionInput" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer" placeholder="Dirección" />
</div>
<p style="color:red" class="mb-4">@MsgError</p>
<button @onclick="ClickModificar" class="text-white bg-gradient-to-br from-pink-500 to-orange-400 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-pink-200 dark:focus:ring-pink-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-2 mb-2">Modificar</button>

@code {
    [Parameter]
    public int Id { get; set; }
    [Parameter]
    public string Correo { get; set; }
    private string nombreInput = "";
    private string apellidoInput = "";
    private string passwordInput = "";
    private string direccionInput = "";
    private string MsgError = "";

    private void LimpiarImputs()
    {
        nombreInput = "";
        apellidoInput = "";
        passwordInput = "";
        direccionInput = "";
    }

    private void ClickModificar()
    {
        try
        {
            Usuario usuario = UsuarioLogic.FindUsuario(Correo);
            if (usuario != null)
            {
                usuario.Nombre = nombreInput;
                usuario.Apellido = apellidoInput;
                usuario.Contrasena = passwordInput;
                usuario.Direccion = direccionInput;
                NavigationManager.NavigateTo($"/home/{Id}/{Correo}");
            }
            else
            {
                MsgError = "El usuario no existe";
                LimpiarImputs();
            }
        }
        catch (DomainUsuarioException e)
        {
            MsgError = e.Message;
            LimpiarImputs();
        }
    }
}
