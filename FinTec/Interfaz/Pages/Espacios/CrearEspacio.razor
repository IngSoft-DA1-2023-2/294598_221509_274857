@page "/home/{Id:int}/{Correo}/CrearEspacios"

<PageTitle>FinTrac Crear Espacio</PageTitle>

<TituloRosado Titulo="Crear Espacio" Subtitulo="Ingrese el nombre del espacio y creé un nuevo espacio, usted será el Administrador."></TituloRosado>

<input class="mt-4 mb-4" @bind="inputNombre" type="text" placeholder="Nombre de Espacio">
<p style="color:red">@ErrorMsg</p>
<button @onclick="() => ClickCrearUsuario()" class="text-white bg-gradient-to-br from-pink-500 to-orange-400 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-pink-200 dark:focus:ring-pink-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-2 mb-2">Crear Nuevo Espacio</button>

@code {
	[Parameter] public int Id { get; set; }
	[Parameter] public string Correo { get; set; }
	[Parameter] public string inputNombre { get; set; }
	[Parameter] public string ErrorMsg { get; set; }
	private List<Espacio> espacios { get; set; } = new List<Espacio>();
	private Usuario usuario { get; set; } = new Usuario();

	protected override void OnInitialized()
	{
		espacios = EspacioLogic.EspaciosByCorreo(Correo);
		usuario = UsuarioLogic.FindUsuario(Correo);
	}

	private void ClickCrearUsuario()
	{
		try{
			Espacio espacio = new Espacio()
			{
				Nombre = inputNombre,
				Admin = usuario,
			};
			EspacioLogic.AddEspacio(espacio);
			espacio.AsignarId();
			NavigationManager.NavigateTo($"/home/{Id}/{Correo}/Espacios");
		}
		catch (DomainEspacioException e)
		{
			ErrorMsg = e.Message;
		}

	}
}
