@page "/home/{Id:int}/{Correo}/CrearCuentaCredito"
@inject NavigationManager NavigationManager;
@using BussinesLogic
@using Domain
@inject UsuarioLogic UsuarioLogic;
@inject EspacioLogic EspacioLogic;
@inject Persistencia Persistencia;

<PageTitle>FinTec Crear Cuenta Credito</PageTitle>

<EspacioActual></EspacioActual>

@code {
	[Parameter] public int Id { get; set; }
	[Parameter] public string Correo { get; set; }
	public string ErrorMsg { get; set; }
	public string Moneda { get; set; }
	public double Pesos { get; set; }
	public DateTime FechaDeCambio { get; set; } = DateTime.Now;


	private Cambio nuevoCambio = new Cambio();

	private void AgregarCambio()
	{
		try
		{
			var espacio = EspacioLogic.FindEspacio(Persistencia.Id);
			Cambio cambio = new Cambio()
				{
					Moneda = Domain.TipoCambiario.Dolar,
					Pesos = Pesos,
					FechaDeCambio = FechaDeCambio.Date
				};
			try
			{
				espacio.AgregarCambio(cambio);
				NavigationManager.NavigateTo($"/home/{Id}/{Correo}/TipoCambiario");
			}
			catch (DomainEspacioException ex)
			{
				ErrorMsg = ex.Message;
			}
		}
		catch (DomainCambioException ex)
		{
			ErrorMsg = ex.Message;
		}
	}
}
